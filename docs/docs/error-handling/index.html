<!DOCTYPE html><html dir="ltr" lang="en" data-ssr=""><head><style data-styles="">document-component ul{-webkit-padding-start:0;}document-component ul code,document-component ul li{font-size:16px;margin-left:18px;}document-component p a{color:#5850ff;text-decoration:none;}document-component p code{font-weight:600;font-family:"Source Code Pro",monospace;font-size:14px;letter-spacing:-.02em;}document-component #introButton{background:var(--primary-color);color:#fff;text-decoration:none;border:none;font-size:13px;font-weight:700;text-transform:uppercase;padding:16px 20px;border-radius:2px;box-shadow:0 8px 16px rgba(0,0,0,.1),0 3px 6px rgba(0,0,0,.08);outline:0;letter-spacing:.04em;transition:all .15s ease;cursor:pointer;}document-component #introButton:hover{box-shadow:0 3px 6px rgba(0,0,0,.1),0 1px 3px rgba(0,0,0,.1);transform:translateY(1px);}site-header{position:fixed;top:0;left:0;right:0;background-color:rgba(255,255,255,.8);-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px);z-index:99;}site-header .logo-link a{margin:0;}site-header .site-header{padding:20px 15px;max-width:1080px;margin:auto;display:flex;flex-direction:row;flex-wrap:nowrap;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-content:center;-ms-flex-line-pack:center;align-content:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;}site-header a,site-header stencil-route-link a{font-size:14px;margin:8px 8px;margin-right:1.4em;color:#86869c;text-decoration:none;font-weight:500;letter-spacing:-.02em;text-decoration:none;transition:all .2s ease;}site-header a:hover,site-header stencil-route-link a.link-active,site-header stencil-route-link a:hover{color:#2b2b38!important;text-decoration:none;}site-header .pull-right{order:0;flex:1 1 auto;text-align:right;}@media screen and (max-width:450px){site-header img{padding-bottom:20px;}site-header .pull-right{display:block;text-align:center;}}@media screen and (min-width:450px){site-header .logo{height:32px;}}@media screen and (max-width:722px){site-header a,site-header stencil-route-link a{font-size:12px;margin:8px 12px;}site-header .pull-right{justify-content:space-around;display:flex;}site-header .site-header{flex-direction:column;}site-header stencil-route-link{margin-right:unset;}}site-menu .star-button{margin-bottom:-2px;width:120px;margin-top:26px;}site-menu h4{font-size:16px;font-weight:700;margin-bottom:0;}site-menu #menu-list{list-style-type:none;margin:0;padding:0;-webkit-padding-start:0;}site-menu #menu-list ul{padding:0;color:#2d2d4c;font-size:15px;line-height:2em;margin:0 0 28px;}site-menu #menu-list li{list-style:none;margin:0;text-indent:0;font-size:14px;font-weight:400;}site-menu a{color:#484854;text-decoration:none;}site-menu stencil-route-link a{color:#484854;text-decoration:none;}site-menu stencil-route-link .link-active{font-weight:700;color:#5850ff;letter-spacing:-.013em;}site-menu stencil-route-link:hover a:not(.link-active){color:#2f2f35!important;font-weight:500;letter-spacing:-.013em;}*{box-sizing:border-box;}stencil-site{height:100%;display:flex;flex-flow:column;}.app{height:100%;max-width:1080px;margin:auto;}#main-div{flex-grow:1;flex-shrink:0;}::selection{background:#e7e7f2;}::-moz-selection{background:#e7e7f2;}body,html{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";width:100%;height:100%;padding:0;margin:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;}h1,h4{color:#16161d;}h1{font-size:28px;font-weight:700;}p,ul{color:#2d2d4c;font-size:15px;line-height:2em;margin:24px 0;}stencil-route-link:hover{cursor:pointer;}.wrapper{line-height:32px;min-height:100%;padding-top:60px;margin:15px;display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:flex-start;align-content:stretch;align-items:flex-start;}pre{word-break:break-all;word-wrap:break-word;display:block;white-space:pre-wrap;margin:24px 0 28px;padding:16px 24px;border-radius:4px;color:#abb2bf;background-color:#16161d;}pre code{font-weight:500;display:block;overflow-x:auto;word-wrap:normal;white-space:pre;box-sizing:border-box;font-size:14px;line-height:20px;}code{font-weight:400;font-family:"Source Code Pro",monospace;font-size:14px;}.hljs-keyword{color:#c678dd;}.hljs-string{color:#98c379;}.hljs-number{color:#d19a66;}.hljs-title{color:#61aeee;}footer{bottom:0;left:0;width:100%;background:#f8f8fc;height:8em;display:flex;justify-content:space-around;align-items:center;flex:0 0 8em;margin-top:32px;}footer .svg-button{margin-left:16px;transition:all .15s ease;}footer .svg-button:hover{opacity:.5;}#open-source img{width:50%;}#open-source p{margin-top:0;margin-bottom:0;color:#a5a4b8;font-size:10px;}@media screen and (max-width:355px){.wrapper{padding-top:100px;}}@media screen and (max-width:450px){.wrapper{padding-top:80px;}site-header a{display:none;}site-header stencil-route-link a{display:initial;}}@media screen and (max-width:590px){.wrapper{margin-right:0;margin-left:0;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-flex-direction:column-reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse;}.wrapper .pull-right{padding:0 15px;width:100%;min-height:100vh;}.wrapper .pull-left{position:relative;padding:15px;width:100%;bottom:0;background-color:#16161d;}.wrapper .pull-left *{color:#fff;}}@media screen and (min-width:590px){.wrapper .pull-left{min-width:250px;max-width:250px;position:-webkit-sticky;position:sticky;top:50px;}.wrapper #version{color:#484854;}.wrapper .pull-right{padding-left:96px;padding-right:32px;flex:1 1 auto;overflow:auto;min-height:100vh;}}</style> <meta charset="utf-8"> <title>Error handling API (Validation) - WP OptionsKit</title> <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes"> <meta name="format-detection" content="telephone=no"> <meta name="description" content="Welcome to Stencil, the magical, reusable web components compiler."> <meta name="msapplication-tap-highlight" content="no"> <meta name="theme-color" content="#16161d"> <link rel="manifest" href="/manifest.json"> <link rel="icon" type="image/x-icon" href="/assets/icon/favicon.ico"> <style>:root{--primary-color:#5851ff;--button-shadow:0 8px 16px rgba(0,0,0,.1),0 3px 6px rgba(0,0,0,.08);--button-shadow-hover:0 4px 6px rgba(0,0,0,.12),0 1px 3px rgba(0,0,0,.08)}</style>
<link rel="canonical" href="/docs/error-handling"></head>
<body> <stencil-site data-ssrv="0" class="hydrated"><!----><div id="main-div" data-ssrc="0.0"><site-header data-ssrc="0.0." data-ssrv="1" class="hydrated"><!----><div class="site-header" data-ssrc="1.0"><stencil-route-link class="logo-link hydrated" data-ssrc="1.0" data-ssrv="5"><a class="link-active" href="/" data-ssrc="5.0."><!----><img class="logo" alt="OptionsKit" src="https://alessandrotesoro.github.io/wp-optionskit/assets/img/logo.png" data-ssrc="1.0."></a></stencil-route-link><div class="pull-right" data-ssrc="1.1"><stencil-route-link data-ssrc="1.0" data-ssrv="6" class="hydrated"><a class="link-active" href="/docs/intro" data-ssrc="6.0."><!----><!--s.1.0-->Documentation<!--/--> </a></stencil-route-link><a href="https://github.com/alessandrotesoro/wp-optionskit" data-ssrc="1.1"><!--s.1.0-->GitHub<!--/--> </a><a href="https://twitter.com/_alessandrotes" data-ssrc="1.2"><!--s.1.0-->Twitter<!--/--> </a></div></div></site-header><div class="app" data-ssrc="0.1"><stencil-router data-ssrc="0.0" data-ssrv="2" class="hydrated"><!----><stencil-route data-ssrc="0.0." data-ssrv="3" class="hydrated"><!----></stencil-route><stencil-route data-ssrc="0.1." data-ssrv="4" class="hydrated"><!----><div class="wrapper" data-ssrc="4.0"><div class="pull-left" data-ssrc="4.0"><site-menu data-ssrc="4.0." data-ssrv="7" class="hydrated"><!----><div data-ssrc="7.0"><div id="version" data-ssrc="7.0"><!--s.7.0-->Version 1.0.0<!--/--> </div><lazy-iframe class="star-button hydrated" data-ssrc="7.1." data-ssrv="9"><!----><div data-ssrc="9.0"><iframe frameborder="0" title="" allowfullscreen="true" scrolling="0" width="170px" height="20px" data-ssrc="9.0." src="https://ghbtns.com/github-btn.html?user=alessandrotesoro&amp;repo=wp-optionskit&amp;type=star&amp;count=true"></iframe></div></lazy-iframe><ul id="menu-list" data-ssrc="7.2"><li data-ssrc="7.0"><h4 data-ssrc="7.0"><!--s.7.0-->Essentials<!--/--> </h4><ul data-ssrc="7.1"><li data-ssrc="7.0"><stencil-route-link data-ssrc="7.0" data-ssrv="10" class="hydrated"><a class="" href="/docs/intro" data-ssrc="10.0."><!----><!--s.7.0-->Introduction<!--/--> </a></stencil-route-link></li><li data-ssrc="7.1"><stencil-route-link data-ssrc="7.0" data-ssrv="11" class="hydrated"><a class="" href="/docs/getting-started" data-ssrc="11.0."><!----><!--s.7.0-->Getting Started<!--/--> </a></stencil-route-link></li></ul></li><li data-ssrc="7.1"><h4 data-ssrc="7.0"><!--s.7.0-->Basics<!--/--> </h4><ul data-ssrc="7.1"><li data-ssrc="7.0"><stencil-route-link data-ssrc="7.0" data-ssrv="12" class="hydrated"><a class="" href="/docs/menu-setup" data-ssrc="12.0."><!----><!--s.7.0-->Setting up the menu<!--/--> </a></stencil-route-link></li><li data-ssrc="7.1"><stencil-route-link data-ssrc="7.0" data-ssrv="13" class="hydrated"><a class="" href="/docs/tabs-and-sections" data-ssrc="13.0."><!----><!--s.7.0-->Adding tabs and sections<!--/--> </a></stencil-route-link></li><li data-ssrc="7.2"><stencil-route-link data-ssrc="7.0" data-ssrv="14" class="hydrated"><a class="" href="/docs/adding-fields" data-ssrc="14.0."><!----><!--s.7.0-->Adding fields<!--/--> </a></stencil-route-link></li><li data-ssrc="7.3"><stencil-route-link data-ssrc="7.0" data-ssrv="15" class="hydrated"><a class="" href="/docs/labels" data-ssrc="15.0."><!----><!--s.7.0-->Labels customization<!--/--> </a></stencil-route-link></li></ul></li><li data-ssrc="7.2"><h4 data-ssrc="7.0"><!--s.7.0-->Advanced<!--/--> </h4><ul data-ssrc="7.1"><li data-ssrc="7.0"><stencil-route-link data-ssrc="7.0" data-ssrv="16" class="hydrated"><a class="" href="/docs/sanitization-filters" data-ssrc="16.0."><!----><!--s.7.0-->Custom sanitization filters<!--/--> </a></stencil-route-link></li><li data-ssrc="7.1"><stencil-route-link data-ssrc="7.0" data-ssrv="17" class="hydrated"><a class="link-active" href="/docs/error-handling" data-ssrc="17.0."><!----><!--s.7.0-->Errors handling<!--/--> </a></stencil-route-link></li><li data-ssrc="7.2"><stencil-route-link data-ssrc="7.0" data-ssrv="18" class="hydrated"><a class="" href="/docs/custom-fields" data-ssrc="18.0."><!----><!--s.7.0-->Custom fields<!--/--> </a></stencil-route-link></li></ul></li><li data-ssrc="7.3"><h4 data-ssrc="7.0"><!--s.7.0-->Social<!--/--> </h4><ul data-ssrc="7.1"><li data-ssrc="7.0"><a href="https://twitter.com/_alessandrotes?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false" data-ssrc="7.0"><!--s.7.0-->Follow @Alessandro Tesoro<!--/--> </a><script async="true" src="https://platform.twitter.com/widgets.js" charset="utf-8" data-ssrc="7.1."></script></li><li data-ssrc="7.1"><a class="github-button" href="https://github.com/alessandrotesoro" aria-label="Follow @alessandrotesoro on GitHub" data-ssrc="7.0"><!--s.7.0-->Follow @alessandrotesoro<!--/--> </a><script async="true" defer="" src="https://buttons.github.io/buttons.js" data-ssrc="7.1."></script></li><li data-ssrc="7.2"><a class="github-button" href="https://github.com/alessandrotesoro/wp-optionskit" data-icon="octicon-star" data-show-count="true" aria-label="Star alessandrotesoro/wp-optionskit on GitHub" data-ssrc="7.0"><!--s.7.0-->Star<!--/--> </a><script async="true" defer="" src="https://buttons.github.io/buttons.js" data-ssrc="7.1."></script></li></ul></li></ul></div></site-menu></div><div class="pull-right" data-ssrc="4.1"><stencil-route data-ssrc="4.0." data-ssrv="8" class="hydrated"><!----><document-component data-ssrc="8.0." data-ssrv="19" class="hydrated"><!----><div data-ssrc="19.0"><app-marked data-ssrc="19.0." data-ssrv="20" class="hydrated"><!----><div data-ssrc="20.0."><h1 id="error-handling-api-validation-">Error handling API (Validation)</h1>
<p>In the previous section we've seen how to add custom sanitization filters. Those same filters can be used to introduce validation for your fields. </p>
<p>When a validation error occurs, the saving process stops with no changes made to the database. Error messages will also display within the options panel.</p>
<p>The following example, we're using the same filter we've used before but we've now introduced a very simple validation method and added an error with the <code>$errors</code> variable. This variable holds the WP_Error class object.</p>
<pre><code class="lang-php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sample_custom_sanitization</span><span class="hljs-params">( $input, $errors, $setting )</span> </span>{

    <span class="hljs-keyword">if</span>( $input !== <span class="hljs-string">'test'</span> ) {
        $errors-&gt;add( $setting[<span class="hljs-string">'id'</span>], <span class="hljs-string">'The error message goes here'</span>, <span class="hljs-keyword">array</span>(
            <span class="hljs-string">'status'</span> =&gt; <span class="hljs-number">422</span>,
            <span class="hljs-string">'label'</span> =&gt; $setting[<span class="hljs-string">'name'</span>]
        ) );
    }

    <span class="hljs-keyword">return</span> trim( wp_strip_all_tags( $input, <span class="hljs-keyword">true</span> ) );
}
add_filter( <span class="hljs-string">'sample2_settings_sanitize_text'</span>, <span class="hljs-string">'sample_custom_sanitization'</span>, <span class="hljs-number">3</span>, <span class="hljs-number">10</span> );
</code></pre>
<p>When using the <code>add</code> method, the first parameter is the ID of the setting. The second parameter is the error message that will be displayed into your options panel. The third parameter is an array containing additional information about the error:</p>
<ul>
<li>status: must always be set to 422, any other error code will not be recognized by the API.</li>
<li>label: is the name of the field that will appear in the message at the top of the screen.</li>
</ul>
<p><stencil-route-link url="/docs/custom-fields" router="#router" custom="true" data-ssrv="21" class="hydrated"><span class="" data-ssrc="21.0."><!----> <button id="introButton"> Next </button>
</span></stencil-route-link></p>
</div></app-marked></div></document-component></stencil-route></div></div></stencil-route></stencil-router></div></div><footer data-ssrc="0.1"><div id="open-source" data-ssrc="0.0"><p data-ssrc="0.0"><!--s.0.0-->Designed and built with ❤️️ by Alessandro Tesoro<!--/--> </p><p data-ssrc="0.1"><!--s.0.0-->Released under the <!--/--> <span id="mit" data-ssrc="0.1"><!--s.0.0-->GPLv3 License<!--/--> </span><!--s.0.2--> | Copyright @ 2018<!--/--> </p></div><div id="footer-icons" data-ssrc="0.1"><a class="svg-button" id="stencil-repo" href="https://github.com/alessandrotesoro/wp-optionskit" target="_blank" rel="noopener" title="Open OptionsKit repository on github" data-ssrc="0.0"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 512 512" data-ssrc="0.0"><path d="M256 32C132.3 32 32 135 32 261.7c0 101.5 64.2 187.5 153.2 218l3.8.3c8.3 0 11.5-6 11.5-11.4l-.3-39c-8.4 1.8-16 2.6-22.6 2.6-43 0-53-33.5-53-33.5-10-26.5-24.8-33.6-24.8-33.6-19.5-13.6 0-14 1.4-14 22.6 2 34.4 23.8 34.4 23.8 11.2 19.6 26.2 25 39.6 25 10.5 0 20-3.3 25.6-6 2-14.7 7.8-24.8 14.2-30.6-49.7-5.8-102-25.5-102-113.5 0-25 8.7-45.6 23-61.6-2.3-5.7-10-29 2.2-60.7 0 0 1.6-.5 5-.5 8 0 26.4 3 56.6 24 18-5 37-7.5 56-7.6 19 0 38.3 2.6 56.2 7.7 30.2-21 48.5-24.2 56.6-24.2 3.4 0 5 .5 5 .5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.2 23 36.7 23 61.7 0 88.2-52.4 107.6-102.3 113.3 8 7 15.2 21 15.2 42.5 0 30.7-.3 55.5-.3 63 0 5.4 3 11.5 11.4 11.5 1.2 0 2.6 0 4-.4 89-30.4 153.2-116.5 153.2-218C480 135 379.7 32 256 32z" data-ssrc="0.0."></path></svg></a><a class="svg-button" id="stencil-twitter" href="https://twitter.com/_alessandrotes" target="_blank" rel="noopener" title="Open twitter" data-ssrc="0.1"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 512 512" data-ssrc="0.0"><path d="M492 109.5c-17.4 7.7-36 13-55.6 15.3 20-12 35.4-31 42.6-53.6-18.7 11-39.4 19.2-61.5 23.5-17.7-19-43-30.7-70.7-30.7-53.5 0-96.8 43.4-96.8 97 0 7.5.8 15 2.5 22-80.5-4-152-42.6-199.6-101.3-8.4 14.3-13.2 31-13.2 48.7C39.8 164 57 193.7 83 211c-16-.3-31-4.7-44-12v1.2c0 47 33.4 86 77.7 95-8 2.2-16.7 3.4-25.5 3.4-6.2 0-12.3-.6-18.2-1.8 12.3 38.5 48 66.5 90.5 67.3-33 26-75 41.6-120.3 41.6-7.8 0-15.5-.5-23-1.4C62.7 432 113.6 448 168 448 346.7 448 444 300.3 444 172.2c0-4.2 0-8.4-.3-12.5 19-13.7 35.3-30.7 48.3-50.2z" data-ssrc="0.0."></path></svg></a></div></footer></stencil-site> <!--<script async defer src="https://buttons.github.io/buttons.js"></script>--> <script>"serviceWorker"in navigator&&"file:"!==location.protocol&&window.addEventListener("load",function(){navigator.serviceWorker.register("/sw.js").then(function(e){console.log("service worker registered",e),e.onupdatefound=function(){var n=e.installing;n.onstatechange=function(){"installed"===n.state&&window.dispatchEvent(new Event("swUpdate"))}}}).catch(function(e){console.log("service worker error",e)})});</script> <script>/*! Built with http://stenciljs.com */
!function(e,t,r,i,o,n,c,s,a,l,p){!function(e,t,r,i,o,n,c,s,a,l,p,u,d){(e.App=e.App||{}).components=p,(d=p.filter(function(e){return e[2]}).map(function(e){return e[0]})).length&&((u=t.createElement("style")).innerHTML=d.join()+"{visibility:hidden}.hydrated{visibility:inherit}",u.setAttribute("data-styles",""),t.head.insertBefore(u,t.head.firstChild)),(u=r[r.length-1])&&u.src&&(n=(d=u.src.split("/").slice(0,-1)).join("/")+(d.length?"/":"")+"app/"),(u=t.createElement("script")).src=n+(function(e,t,r,i){return t.search.indexOf("core=es5")>-1||"file:"===t.protocol||!e.customElements||!e.fetch||!(e.CSS&&e.CSS.supports&&e.CSS.supports("color","var(--c)"))||!("noModule"in r)||function(e){try{return new Function('import("")'),!1}catch(e){}return!0}()}(e,e.location,u)?"app.m6zfgcl9.js":"app.ucumfbl5.js"),u.setAttribute("data-path",n),u.setAttribute("data-namespace","app"),t.head.appendChild(u)}(e,t,t.scripts,0,0,"/build/app/",0,0,0,0,[["app-marked","e35zse16",1,[["content",5],["doc",1,1,2],["isServer",3,0,0,"isServer"]]],["document-component","e35zse16",1,[["pages",1]]],["landing-page","triafowf",1,[["el",7],["isServer",3,0,0,"isServer"]]],["lazy-iframe","bayssvoa",1,[["el",7],["frameBorder",1,"frame-border",2],["height",1,1,2],["realSrc",5],["scrolling",1,1,2],["src",1,1,2],["title",1,1,2],["width",1,1,2]]],["pwas-page","xzrtjtph",1],["resources-page","dyoj3lkk",1],["site-header","e35zse16",1],["site-menu","e35zse16",1,[["version",5]]],["stencil-route","e35zse16",0,[["activeRouter",3,0,0,"activeRouter"],["component",1,1,2],["componentProps",1],["exact",1,1,3],["group",1,1,2],["location",3,0,0,"location"],["match",5],["routeRender",1],["url",1]]],["stencil-route-link","r7jvoom2",0,[["activeClass",1,1,2],["activeRouter",3,0,0,"activeRouter"],["custom",1,1,3],["exact",1,1,3],["location",3,0,0,"location"],["match",5],["url",1,1,2],["urlMatch",1]]],["stencil-router","e35zse16",0,[["activeRouter",3,0,0,"activeRouter"],["historyType",1],["match",5],["root",1,1,2],["titleSuffix",1,1,2]]],["stencil-site","e35zse16",1]],void 0)}(window,document);</script></body></html>